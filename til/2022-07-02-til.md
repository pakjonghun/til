---
date: 2022-07-02
category: til, aws
---

## 오늘 한 일

- til 블로그 작성(완료)
- til 블로그 배포 및 도메인 연결(완료)

## 어려운점

- 블로그 백엔드는 nestjs 로 만들었고 api 가 2개 뿐이라 간단하게 작성 할 수 있었다.
  - 역시 구조 신경안쓰고 작성하니 빠르게 작성 할 수 있었다.
  - cache 클레스를 별도의 프로바이더로 만들어서 써먹었는데 재미있었다.
  - 배포 할 때도 이전에 했을 때 보다 빠르게 작성 해서 완료 할 수 있었다.
- 프론트는 react 로 무한스크롤, windowing 을 적용했다.
  - unmount 될때 애니메이션이 적용 안되는줄 알고 있었는데
  - onAnimationEnd 속성을 이용해서 작성 하면 쉽게 만들 수 있었고 이때 별도로 함수를 빼 줘서 적용해야 제대로 작동했다.
  - virtualize 기능은 라이브러리 도움 받지 않고 작성했는데
    - 이전에 작성한 내용에 추가로 로딩 시 스켈레톤 빈화면을 적용하는 방식을 사용했다.
    - 생각은 했었지만 어떻게 하는지 몰라서 안했던 것인데 의외로 잘 작성이 되서 좋았다.
- aws 배포 과정
  - ec2 세팅
    - ec2 를 만들고 ubuntu
    - ubuntu 에 apt 를 업데이트 한다. sudo apt update
    - git 을 설치하고 sudo apt install git
    - nvm 을 설치한다
      ```
        - curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh|bash
        - nvm 설치 방법 https://github.com/nvm-sh/nvm
        - ~/.nvm/nvm.sh
        - 권한 없다고 뜨면 chmod -x ~/.nvm/nvm.sh 한 후에 다시 실행
        - 위 명령어가 잘 안되면
        - `그래도 안되면 이 명령어 실행 후 source ~/.bashrc`
        - nvm install 14.18.1 잘 되는 버전의 node 를 설치한다.
      ```
    - 백 프론트 모두 git clone 받아서 클론받은 패키지를 npm 으로 설치한다.
    - 이때 빌드 될 스크립트 및 빌드 할때 필요한 모든 것을 다 로컬에서 작업 해 놓은 채로 git 저장소에 올려야 한다.
    - npm i pm2 -g pm2 를 글로벌로 설치해서
    - pm2 로 프론트 백 모두 실행 해 주면 끝
    - 실행 명령은 아래와 같은데 상황에 따라 달라 질 수 있음(구글링 하거라 옵션 검색하면 됨)
      ```
        fe : pm2 serve --name 'fe' --spa ./build
        be : pm2 start --name 'be' 'npm start:prod'
      ```
  - ec2 에 ip 와 도메인 설정
    - ec2 에 탄력적 ip 를 넣어주고 ec2 한번 껏다 켜 준다(이렇게 안하면 속도가 조금 느리다)
    - 탄력적 ip 는 ec2 껏다 켜도 안변하는 고정 ip 이므로 편하다.
    - ip 요금은 아래와 같다.(바뀔 수도 있음)
      - 탄력적 ip 는 1개만 연결 해 놓으면 무료
      - 연결 안해놓으면 계속 시간 단위로 과금
      - 2개 이상부터 과금
    - route S5 서비스에 들어가서 호스트를 만든다
      - 호스트는 퍼블릭으로 만들고
      - 도메인은 내가 보유한 도메인으로 적어준다(이거 몰라서 도메인 하나 aws 에서 샀는데
      - 아까워....
    - route S5 호스트 안에 도메인을 만들고 네임서버 정보를 알아낸다
      - 처음 레코드를 만들면 aws 네임서버를 주는데
      - 여기에 레코드 2개를 더 등록 해 준다
        - a레코드로 탄력적 ip 를 가르키도록 값을 넣어주고
        - 또 a 레코드로 www 가 탄력적 ip 를 가르키도록 값을 넣어주고
    - 도메인 산 곳에 가서 네임서버를 넣어준다. aws 에서 제공하는 네임서버 4개를 끝에 . 빼고 넣어준다.
    - 몇시간에서 하루 정도 지나면 도메인이 잘 적용 되 있다.
- 프론트 앤드에 대한 생각이 바뀌다
  - 간단히 단순히 화면을 만들고
  - 데이터를 연결 시키고
  - 글로벌 관리할 스토어 만들어서 컴포넌트에 넣어주고 등등
  - 위 3가지 일이 프론트를 배우는 입장에서 해야 할 일이라고 알고 계속 반복 해왔다.
  - 하지만 dribble 을 보면서 생각이 바뀌었는데
  - ui 를 고민하고 사용자가 사용하기 편하고, 질리지 않고 계속 이용 할 수 있게 animation 을 넣어줘야한다는점 을 알게됬다.
  - animation 은 별로 고민도 안하고 신경도 안쓰던 부분인데 이 부분이 중요 할 수 있다는 것을 알게 되었고
  - 성능에 영향을 미치지 않게 잘 넣어야 되는 것도 알게됬다.

## 해야 할 일

- 프론트 애니메이션 적용 연습 핦 프로젝트 구상
- 간단한 2d video 게임을 react 로 만드는 로직으로 이것저것 적용해 보는 것도 좋을 것 같다는 생각을 함.
