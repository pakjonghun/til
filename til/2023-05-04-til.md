---
date: 2023-05-04
category: til
---

## 캔버스 vs svg vs webgl

- canvas
  - 캔버스는 매우 다이나믹한 로우 레벨의 html tag 이며
  - 로우 레벨인 만큼 자유도가 높지만
  - 그만큼 사용하기 불편하고 개발 하는데 퍼포먼스도 떨어진다.
  - 처음에 이런게 있구나 정도만 알고, 한두번 사용해본 정도...
  - canvas 를 쉽게 사용 하도록 도와주는 library 가 많이 있는데
  - 그중 하나가 fabric 이다. 지금 사용중. ㅋㅋ
  - fabric 을 사용해보니 기능이 많이 구현되 있어서 갖다가 쓰기만 하면 되는 수준이었다.
  - 하지만 버전업데이트가 잘 되지 않고, 관리도 잘 안되며(예문이 싹다 구버전... 알아서 폴링 해야되??!?)
  - 레거시가 매우 많았으며,
  - 불친절한 doc, 매우 좁은 생태계? 문제해결을 위한 커뮤니티가 빈약한 것이 문제였다.
  - 하지만 계속 사용 해보면서 적응을 해서 별 문제가 되지는 않지만,
  - 그래도 여전히 성능(render 엔진 부재)에 문제가 있는 한계가 있다.
- webgl
  - canvas 의 성능 문제를 해결하기 위해서 사용했다.
  - 캔버스를 사용하거나 혹은 webgl 엔진을 사용하는 pixijs 를 사용해보았다.
  - 결과는 대만족 스러운듯 보였다.
  - 프레임 저하가 거의 느껴지지 않을 정도로 여러개의 객체를 화면에 띄워서
  - 성능이 좋으니 애니메이션도 자유롭게 줄 수 있었다.
  - 하지만 사용하면서 알게 된 매우 치명적인 단점이 있었으니..
  - 바로 vector 가 아닌 bitmap 이라는 것...
  - svg loader 방법이 있긴 하지만 ... 또 캔버스 에서 사용하는 메서드를 쉽게 사용하도록 추상화된 api를 제공하고 있긴 하지만...
  - svg 는 역시 확대하면 비트맵인 것이 바로 드러날 정도로 이미지가 깨져버리고..
  - graphic (canvas) 는 잘 확대되는 것 같지만...
  - 나머지 text 나 sprite 가 모두 확대하면 깨져 버리는 문제가 있었다.
  - 물론 커뮤니티에서 제시하는 해결방법이 있긴 했다.
  - scalemode 를 nest 로 바꿔서 적용하거나
  - 필터를 사용해서 퀄리티를 올리라는 글을 보고 따라 해봤지만
  - 유의미한 퀄리티의 상승은 없었다... 그냥 거의 똑같았음...
  - 성능은 좋고 잘 배워두면 써먹을 곳이 많아 보였지만 화질이 정말 안좋다.(옛날 2d 게임 개발에 인기가 많았을 것 같은... 구 시대의... 라이브러리라는 느낌...)
- 마지막으로 svg 로 어떻게 할 수 없을까?
  - 자자 마지막으로 d3를 사용해봤다.
  - 이 라이브러리는 주간 다운로드가 200만이 넘어서 기대가 컸고,
  - 참 좋았다.??
  - value를 수치를 원하는 range 에서 계산 해 주는 기능(이거 애니메이션 인데??)
  - svg 를 정말로 사용하기 편하게 만들어 주는 각종 메서드, api
  - 메서드 체이닝은 기본이고...
  - 정말 맛만 봤는데 너무 좋았다.
  - 이래서 사람들이 많이 사용하는구나 싶었다.
  - 하지만... 이라이브러리는 성능이 가장 구리다. svg 를 이용해서 data driven 의 목적으로
  - 사용하는 것 뿐... 성능 향상을 위한 방법은 아니었다.
  - pixijs 와 섞어서 사용한다고 하더라도. 화질에 문제가 남아 있을 수 밖에 없었다.

## 결론

- 답이 없다
- 혹시나 해서 fabric 에 webgl 을 붙일 수 있는지 찾아봤는데
- 아마 예전에는 붙일 수 있었던 것 같았다. 지금은 안되는 듯....
- gpt 가 가능하다고 해서 알아봤는데 역시... 안되는 방법이었다. ㅠ ㅠ
- 당장은 fabric 에서 성능개선 이라기 보다는
- 기능구현을 계속 해 나가는 수 밖에 없을 것 같다.
- 그리고 나중에 아예 canvas 로 row level 로 직접 구현해 놓고
- webgl 을 붙이는 것이 유일한 해결책으로 보이지만
- 엄청난 오버헤드라는 생각이 든다.
- 차라리 d3 pixijs 를 꾸준히 파서 (pixijs 는 버전을 좀 낮추고, d3 는 좌표 계산하는 용도로만 사용)
- 다른사람 예문을 보니까 pixijs 성능과 d3 의 좌표계산을 섞어서 꽤 그럴싸 한 작품을 만든 예제를 봄.
- fabric 다음 버전에서 성능이 계속 문제가 될 경우 개선하는 방법을 생각해 봐야겠다.
